<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="/fragments/partials :: head('Edit your remindr')"></head>
<body>
<nav th:replace="/fragments/partials :: navbar"></nav>
<div class="container">
    <h1>Edit your remindr event</h1>
    <form th:action="${'/remindrs/'+ remindr.id +'/edit'}" method="post" th:object="${remindr}">
        <!--TITLE-->
        <div class="form-group">
            <label for="title">Event title</label>
            <input id="title" name="title" th:field="*{title}" class="form-control" type="text" required="required"/>
        </div>
        <div
                class="alert alert-danger"
                th:if="${#fields.hasErrors('title')}"
                th:errors="*{title}" >
        </div>

        <!--DESCRIPTION-->
        <div class="form-group">
            <label for="description">Event description (optional) </label>
            <textarea class="form-control" rows="3" id="description" name="description" th:field="*{description}"></textarea>
        </div>

        <!--START DATE/TIME-->
        <div class="form-group">
            <label for="startDateTime">Event start date/ time </label>
            <input id="startDateTime" name="startDateTime" class="form-control" type="datetime-local" th:field="*{startDateTime}" required="required" min="2017-06-01T00:00" max="3000-01-01T00:00"/>
        </div>
        <div
                class="alert alert-danger"
                th:if="${#fields.hasErrors('startDateTime')}"
                th:errors="*{startDateTime}" >
        </div>

        <!--Click this to toggle optional enddate form-->
        <label for="optional-enddate">Set an end date</label>
        <input id="optional-enddate" type="checkbox" />

        <!--END DATE/TIME-->
        <!--<div class="form-group">-->
        <!--<label for="endDateTime" style="display:none;" id="enddate-label">Event end date/ time (optional)</label>-->
        <input id="endDateTime" name="endDateTime" class="form-control" style="display:none;" type="datetime-local" th:field="*{endDateTime}" min="2017-06-01T00:00" max="3000-01-01T00:00"/>
        <!--</div>-->
        <div
                class="alert alert-danger"
                th:if="${#fields.hasErrors('endDateTime')}"
                th:errors="*{endDateTime}" >
        </div>

        <!--Click this to toggle optional recurring form-->
        <label for="optional-recurring">Recurring event</label>
        <input id="optional-recurring" type="checkbox" />


        <!--RECURRING EVENT INFO-->
        <div id='selector' class="form-group">
            <label class="hidden" id="recurring-label" for="recurrence">Recurring event (optional) </label>
            <input class="form-control hidden" name="recurrence" id="recurrence" th:field="*{recurrence}"/>
        </div>

        <!--TIME ZONE LIST-->
        <div class="form-group">
            <label for="timeZone">Event Timezone</label>
            <select id="timeZone" name="timezone">
                <option timeZoneId="3" gmtAdjustment="GMT-10:00" useDaylightTime="0" value="US/Hawaii">(GMT-10:00) Hawaii</option>
                <option timeZoneId="4" gmtAdjustment="GMT-09:00" useDaylightTime="1" value="US/Alaska">(GMT-09:00) Alaska</option>
                <option timeZoneId="5" gmtAdjustment="GMT-08:00" useDaylightTime="1" value="US/Pacific">(GMT-08:00) Pacific Time (US &amp; Canada)</option>
                <option timeZoneId="9" gmtAdjustment="GMT-07:00" useDaylightTime="1" value="US/Mountain">(GMT-07:00) Mountain Time (US &amp; Canada)</option>
                <option timeZoneId="11" gmtAdjustment="GMT-06:00" useDaylightTime="1" value="US/Central">(GMT-06:00) Central Time (US &amp; Canada)</option>
                <option timeZoneId="15" gmtAdjustment="GMT-05:00" useDaylightTime="1" value="US/Eastern">(GMT-05:00) Eastern Time (US &amp; Canada)</option>
            </select>
        </div>

        <!--LOCATION-->
        <div class="form-group">
            <label for="location">Event location</label>
            <input type="text" id="location" name="location" th:field="*{location}" class="form-control" />
        </div>
        <div
                class="alert alert-danger"
                th:if="${#fields.hasErrors('location')}"
                th:errors="*{location}" >
        </div>

            <input type="submit" class="btn btn-primary"/>
        </form>
        <a href="/remindrs" class="btn btn-danger">Cancel</a>

        <!--&lt;!&ndash;UPLOAD AN IMAGE&ndash;&gt;-->
        <!--<h2>Upload an Image</h2>-->

</div>

<div th:replace="/fragments/partials :: scripts"></div>
<script type="text/javascript" src="/scripts/cron/jquery-cron.js"></script>
<script th:inline="javascript" type="text/javascript">
    $(document).ready(function() {
            $("#endDateTime").val('');

            // check if the checkbox is checked (say that five times fast!!)
            $("#optional-enddate").click(function () {
                var isItChecked = $('#optional-enddate').prop('checked');

                if (isItChecked) {
                    console.log("It's checked!");

                    $("#endDateTime").show();
//                $("#enddate-label").show();
//                $("#enddate-label").attr("style","display:block;");

                } else {
                    console.log("It's not checked!");
                    $("#endDateTime").hide();
                    $("#endDateTime").val('');
                    $("#enddate-label").hide();
                }
            });


            $("#optional-recurring").click(function () {
                var isItChecked = $('#optional-recurring').prop('checked');

                if (isItChecked) {
                    console.log("It's checked!");

                    // if it's checked, show the cron field
                    $('#selector').cron({
                        initial: "0 12 * * 5",
                        onChange: function() {
                            $('#recurrence').val($(this).cron("value"));
                        }
                    });

                    // apply cron with default options
                    var recurrence=[[${remindr.recurrence}]];

                    // Updating the value of an existing cron object
                    cron_field.cron("value", recurrence);

                    // if it's checked, show the cron field and its label
                    $("#recurring-label").show();
                    $("#selector").show();

                } else {
                    console.log("It's not checked!");

                    $("#selector").hide();
                    $("#recurring-label").hide();
                }
            });

        });
</script>
</body>
</html>